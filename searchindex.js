Search.setIndex({"alltitles": {"API Reference:": [[6, null]], "Accessing Module I/O": [[3, "accessing-module-i-o"]], "Accessing the PyTorch modules using renaming": [[1, "accessing-the-pytorch-modules-using-renaming"]], "Activation Collection": [[10, "activation-collection"]], "Added": [[4, "added"]], "Adding Support for Your Model": [[0, null]], "Advanced Features": [[1, null]], "Analysis Methods": [[7, "analysis-methods"]], "Attention Implementation": [[8, "attention-implementation"]], "Attention Probabilities": [[1, "attention-probabilities"]], "Attention Probabilities (Optional)": [[0, "attention-probabilities-optional"]], "Automatic Testing System": [[8, "automatic-testing-system"]], "Basic Activation Access": [[5, "basic-activation-access"]], "Basic Gradient Computation": [[9, "basic-gradient-computation"]], "Basic RenameConfig Usage": [[0, "basic-renameconfig-usage"]], "Basic Usage": [[3, null]], "Built-in Methods": [[3, "built-in-methods"]], "Caching Activations": [[9, "caching-activations"]], "Changelog": [[4, null]], "Combined with Interventions": [[1, "combined-with-interventions"]], "Direct Assignment": [[5, "direct-assignment"]], "Documentation": [[2, null]], "Don\u2019t forget the execution order!": [[9, "don-t-forget-the-execution-order"]], "Execution Order Requirements": [[9, "execution-order-requirements"]], "Getting Started:": [[6, null]], "Gradient Computation": [[9, "gradient-computation"]], "Installation": [[5, "installation"]], "Internal Modules": [[2, "internal-modules"]], "Interventions": [[7, null]], "Layer Access": [[10, "layer-access"]], "Loading Models": [[3, "loading-models"]], "Logit Lens": [[7, "logit-lens"]], "Manual Testing": [[8, "manual-testing"]], "Model Dispatch": [[8, "model-dispatch"]], "Model Validation & Testing": [[8, null]], "Multiple Alternative Names": [[0, "multiple-alternative-names"]], "Multiple Backward Passes": [[9, "multiple-backward-passes"]], "NNsight Best Practices": [[9, null]], "NNsight Utils": [[10, null]], "Next Steps": [[5, "next-steps"]], "Patchscope": [[7, "patchscope"]], "Path-Based Renaming": [[0, "path-based-renaming"]], "Performance Optimization": [[9, "performance-optimization"]], "Plot Target Evolution": [[1, "plot-target-evolution"]], "Projection and Utilities": [[10, "projection-and-utilities"]], "Prompt Analysis": [[1, "prompt-analysis"]], "Prompt Utilities": [[1, "prompt-utilities"]], "Quick Start": [[5, null]], "Real Example: GPT-J Support": [[0, "real-example-gpt-j-support"]], "Renaming a LanguageModel or NNsight class": [[1, "renaming-a-languagemodel-or-nnsight-class"]], "Requirements": [[10, "requirements"]], "Setup": [[10, "setup"]], "Skip Layers": [[3, "skip-layers"]], "Standardized Interface": [[3, "standardized-interface"]], "Testing Your Configuration": [[0, "testing-your-configuration"]], "Trade-offs and Configuration": [[8, "trade-offs-and-configuration"]], "Troubleshooting": [[0, "troubleshooting"]], "Understanding the Target Structure": [[0, "understanding-the-target-structure"]], "Use tracer.stop() to Skip Unnecessary Computations": [[9, "use-tracer-stop-to-skip-unnecessary-computations"]], "User Guide:": [[6, null]], "Using nnterp\u2019s renaming with LanguageModel or NNsight classes": [[1, "using-nnterp-s-renaming-with-languagemodel-or-nnsight-classes"]], "Version Compatibility": [[8, "version-compatibility"]], "Visualization": [[1, "visualization"]], "What nnterp Cannot Guarantee": [[8, "what-nnterp-cannot-guarantee"]], "What nnterp Guarantees": [[8, "what-nnterp-guarantees"]], "Your First Model": [[5, "your-first-model"]], "[Unreleased]": [[4, "unreleased"]], "nnterp - NNsight wrapper for Large Language Models": [[6, null]], "nnterp.display module": [[2, "module-nnterp.display"]], "nnterp.interventions module": [[2, "module-nnterp.interventions"]], "nnterp.nnsight_utils module": [[2, "module-nnterp.nnsight_utils"]], "nnterp.prompt_utils module": [[2, "module-nnterp.prompt_utils"]], "nnterp.rename_utils module": [[2, "module-nnterp.rename_utils"]], "nnterp.standardized_transformer module": [[2, "module-nnterp.standardized_transformer"]], "nnterp.utils module": [[2, "module-nnterp.utils"]]}, "docnames": ["adding-model-support", "advanced-features", "api", "basic-usage", "changelog", "getting-started/quickstart", "index", "interventions", "model-validation", "nnsight-best-practices", "nnsight-utils"], "envversion": {"nbsphinx": 4, "sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["adding-model-support.rst", "advanced-features.rst", "api.rst", "basic-usage.rst", "changelog.rst", "getting-started/quickstart.rst", "index.rst", "interventions.rst", "model-validation.rst", "nnsight-best-practices.rst", "nnsight-utils.rst"], "indexentries": {"add_prefix_false_tokenizer (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.add_prefix_false_tokenizer", false]], "architecturenotfound (class in nnterp.utils)": [[2, "nnterp.utils.ArchitectureNotFound", false]], "attention_mask (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.attention_mask", false]], "attentionprobabilitiesaccessor (class in nnterp.rename_utils)": [[2, "nnterp.rename_utils.AttentionProbabilitiesAccessor", false]], "attn_head_config_key (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.attn_head_config_key", false]], "attn_name (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.attn_name", false]], "attn_prob_source (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.attn_prob_source", false]], "attn_probs_available (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.attn_probs_available", false]], "attnprobfunction (class in nnterp.rename_utils)": [[2, "nnterp.rename_utils.AttnProbFunction", false]], "auto() (targetpromptbatch static method)": [[2, "nnterp.interventions.TargetPromptBatch.auto", false]], "bloom_attention_prob_source() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.bloom_attention_prob_source", false]], "check_io() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.check_io", false]], "check_model_renaming() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.check_model_renaming", false]], "check_source() (attentionprobabilitiesaccessor method)": [[2, "nnterp.rename_utils.AttentionProbabilitiesAccessor.check_source", false]], "collect_last_token_activations_session() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.collect_last_token_activations_session", false]], "collect_token_activations_batched() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.collect_token_activations_batched", false]], "compute_next_token_probs() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.compute_next_token_probs", false]], "default_attention_prob_source() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.default_attention_prob_source", false]], "default_attn_head_config_keys() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.default_attn_head_config_keys", false]], "default_hidden_size_config_keys() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.default_hidden_size_config_keys", false]], "default_vocab_size_config_keys() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.default_vocab_size_config_keys", false]], "detect_layer_output_type() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.detect_layer_output_type", false]], "disable() (attentionprobabilitiesaccessor method)": [[2, "nnterp.rename_utils.AttentionProbabilitiesAccessor.disable", false]], "display_markdown() (in module nnterp.utils)": [[2, "nnterp.utils.display_markdown", false]], "display_source() (in module nnterp.utils)": [[2, "nnterp.utils.display_source", false]], "dummy_inputs() (in module nnterp.utils)": [[2, "nnterp.utils.dummy_inputs", false]], "dummycache (class in nnterp.utils)": [[2, "nnterp.utils.DummyCache", false]], "expand_path_with_model() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.expand_path_with_model", false]], "from_prompts() (targetpromptbatch class method)": [[2, "nnterp.interventions.TargetPromptBatch.from_prompts", false]], "from_strings() (prompt class method)": [[2, "nnterp.prompt_utils.Prompt.from_strings", false]], "from_target_prompt() (targetpromptbatch class method)": [[2, "nnterp.interventions.TargetPromptBatch.from_target_prompt", false]], "from_target_prompts() (targetpromptbatch class method)": [[2, "nnterp.interventions.TargetPromptBatch.from_target_prompts", false]], "get_attention() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_attention", false]], "get_attention() (moduleaccessor method)": [[2, "nnterp.nnsight_utils.ModuleAccessor.get_attention", false]], "get_attention_output() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_attention_output", false]], "get_attention_prob_source() (attnprobfunction method)": [[2, "nnterp.rename_utils.AttnProbFunction.get_attention_prob_source", false]], "get_embed_tokens() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_embed_tokens", false]], "get_embed_tokens() (moduleaccessor method)": [[2, "nnterp.nnsight_utils.ModuleAccessor.get_embed_tokens", false]], "get_first_tokens() (in module nnterp.prompt_utils)": [[2, "nnterp.prompt_utils.get_first_tokens", false]], "get_hidden_size() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.get_hidden_size", false]], "get_ignores() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.get_ignores", false]], "get_layer() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_layer", false]], "get_layer_input() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_layer_input", false]], "get_layer_output() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_layer_output", false]], "get_layers() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_layers", false]], "get_layers() (moduleaccessor method)": [[2, "nnterp.nnsight_utils.ModuleAccessor.get_layers", false]], "get_logits() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_logits", false]], "get_mlp() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_mlp", false]], "get_mlp() (moduleaccessor method)": [[2, "nnterp.nnsight_utils.ModuleAccessor.get_mlp", false]], "get_mlp_output() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_mlp_output", false]], "get_module() (layeraccessor method)": [[2, "nnterp.rename_utils.LayerAccessor.get_module", false]], "get_next_token_probs() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_next_token_probs", false]], "get_num_attention_heads() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.get_num_attention_heads", false]], "get_num_layers() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_num_layers", false]], "get_rename_dict() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.get_rename_dict", false]], "get_target_probs() (prompt method)": [[2, "nnterp.prompt_utils.Prompt.get_target_probs", false]], "get_token_activations() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_token_activations", false]], "get_topk_closest_tokens() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.get_topk_closest_tokens", false]], "get_unembed() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_unembed", false]], "get_unembed() (moduleaccessor method)": [[2, "nnterp.nnsight_utils.ModuleAccessor.get_unembed", false]], "get_unembed_norm() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.get_unembed_norm", false]], "get_unembed_norm() (moduleaccessor method)": [[2, "nnterp.nnsight_utils.ModuleAccessor.get_unembed_norm", false]], "get_vocab_size() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.get_vocab_size", false]], "gpt2_attention_prob_source() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.gpt2_attention_prob_source", false]], "gptj_attention_prob_source() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.gptj_attention_prob_source", false]], "has_no_collisions() (prompt method)": [[2, "nnterp.prompt_utils.Prompt.has_no_collisions", false]], "hidden_size (standardizedtransformer attribute)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.hidden_size", false]], "hidden_size_config_key (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.hidden_size_config_key", false]], "ignore_attn (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.ignore_attn", false]], "ignore_mlp (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.ignore_mlp", false]], "index_to_patch (targetprompt attribute)": [[2, "nnterp.interventions.TargetPrompt.index_to_patch", false]], "index_to_patch (targetpromptbatch attribute)": [[2, "nnterp.interventions.TargetPromptBatch.index_to_patch", false]], "input (iotype attribute)": [[2, "nnterp.rename_utils.IOType.INPUT", false]], "input_ids (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.input_ids", false]], "input_size (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.input_size", false]], "iotype (class in nnterp.rename_utils)": [[2, "nnterp.rename_utils.IOType", false]], "is_notebook() (in module nnterp.utils)": [[2, "nnterp.utils.is_notebook", false]], "layeraccessor (class in nnterp.rename_utils)": [[2, "nnterp.rename_utils.LayerAccessor", false]], "layers_name (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.layers_name", false]], "lm_head_name (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.lm_head_name", false]], "ln_final_name (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.ln_final_name", false]], "logit_lens() (in module nnterp.interventions)": [[2, "nnterp.interventions.logit_lens", false]], "logits (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.logits", false]], "mlp_name (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.mlp_name", false]], "model_name (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.model_name", false]], "module": [[2, "module-nnterp.display", false], [2, "module-nnterp.interventions", false], [2, "module-nnterp.nnsight_utils", false], [2, "module-nnterp.prompt_utils", false], [2, "module-nnterp.rename_utils", false], [2, "module-nnterp.standardized_transformer", false], [2, "module-nnterp.utils", false]], "moduleaccessor (class in nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.ModuleAccessor", false]], "next_token_probs (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.next_token_probs", false]], "next_token_probs_unsqueeze() (in module nnterp.prompt_utils)": [[2, "nnterp.prompt_utils.next_token_probs_unsqueeze", false]], "nnterp.display": [[2, "module-nnterp.display", false]], "nnterp.interventions": [[2, "module-nnterp.interventions", false]], "nnterp.nnsight_utils": [[2, "module-nnterp.nnsight_utils", false]], "nnterp.prompt_utils": [[2, "module-nnterp.prompt_utils", false]], "nnterp.rename_utils": [[2, "module-nnterp.rename_utils", false]], "nnterp.standardized_transformer": [[2, "module-nnterp.standardized_transformer", false]], "nnterp.utils": [[2, "module-nnterp.utils", false]], "num_heads (standardizedtransformer attribute)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.num_heads", false]], "num_layers (standardizedtransformer attribute)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.num_layers", false]], "output (iotype attribute)": [[2, "nnterp.rename_utils.IOType.OUTPUT", false]], "patch_object_attn_lens() (in module nnterp.interventions)": [[2, "nnterp.interventions.patch_object_attn_lens", false]], "patchscope_generate() (in module nnterp.interventions)": [[2, "nnterp.interventions.patchscope_generate", false]], "patchscope_lens() (in module nnterp.interventions)": [[2, "nnterp.interventions.patchscope_lens", false]], "plot_topk_tokens() (in module nnterp.display)": [[2, "nnterp.display.plot_topk_tokens", false]], "print_source() (attentionprobabilitiesaccessor method)": [[2, "nnterp.rename_utils.AttentionProbabilitiesAccessor.print_source", false]], "probs_to_dict() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.probs_to_dict", false]], "project_on_vocab() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.project_on_vocab", false]], "project_on_vocab() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.project_on_vocab", false]], "prompt (class in nnterp.prompt_utils)": [[2, "nnterp.prompt_utils.Prompt", false]], "prompt (prompt attribute)": [[2, "nnterp.prompt_utils.Prompt.prompt", false]], "prompt (targetprompt attribute)": [[2, "nnterp.interventions.TargetPrompt.prompt", false]], "prompts (targetpromptbatch attribute)": [[2, "nnterp.interventions.TargetPromptBatch.prompts", false]], "prompts_to_df() (in module nnterp.display)": [[2, "nnterp.display.prompts_to_df", false]], "renameconfig (class in nnterp.rename_utils)": [[2, "nnterp.rename_utils.RenameConfig", false]], "renamingerror": [[2, "nnterp.rename_utils.RenamingError", false]], "repeat_prompt() (in module nnterp.interventions)": [[2, "nnterp.interventions.repeat_prompt", false]], "returns_tuple (layeraccessor property)": [[2, "nnterp.rename_utils.LayerAccessor.returns_tuple", false]], "run() (prompt method)": [[2, "nnterp.prompt_utils.Prompt.run", false]], "run_prompts() (in module nnterp.prompt_utils)": [[2, "nnterp.prompt_utils.run_prompts", false]], "set_layer_output() (in module nnterp.nnsight_utils)": [[2, "nnterp.nnsight_utils.set_layer_output", false]], "skip_layer() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.skip_layer", false]], "skip_layers() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.skip_layers", false]], "standardizedtransformer (class in nnterp.standardized_transformer)": [[2, "nnterp.standardized_transformer.StandardizedTransformer", false]], "steer() (standardizedtransformer method)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.steer", false]], "target_strings (prompt attribute)": [[2, "nnterp.prompt_utils.Prompt.target_strings", false]], "target_tokens (prompt attribute)": [[2, "nnterp.prompt_utils.Prompt.target_tokens", false]], "targetprompt (class in nnterp.interventions)": [[2, "nnterp.interventions.TargetPrompt", false]], "targetpromptbatch (class in nnterp.interventions)": [[2, "nnterp.interventions.TargetPromptBatch", false]], "text_config() (in module nnterp.rename_utils)": [[2, "nnterp.rename_utils.text_config", false]], "to_legacy_cache() (dummycache method)": [[2, "nnterp.utils.DummyCache.to_legacy_cache", false]], "token_embeddings (standardizedtransformer property)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.token_embeddings", false]], "tokenizationerror": [[2, "nnterp.prompt_utils.TokenizationError", false]], "try_with_scan() (in module nnterp.utils)": [[2, "nnterp.utils.try_with_scan", false]], "unpack_tuple() (in module nnterp.utils)": [[2, "nnterp.utils.unpack_tuple", false]], "vocab_size (standardizedtransformer attribute)": [[2, "nnterp.standardized_transformer.StandardizedTransformer.vocab_size", false]], "vocab_size_config_key (renameconfig attribute)": [[2, "nnterp.rename_utils.RenameConfig.vocab_size_config_key", false]]}, "objects": {"nnterp": [[2, 0, 0, "-", "display"], [2, 0, 0, "-", "interventions"], [2, 0, 0, "-", "nnsight_utils"], [2, 0, 0, "-", "prompt_utils"], [2, 0, 0, "-", "rename_utils"], [2, 0, 0, "-", "standardized_transformer"], [2, 0, 0, "-", "utils"]], "nnterp.display": [[2, 1, 1, "", "plot_topk_tokens"], [2, 1, 1, "", "prompts_to_df"]], "nnterp.interventions": [[2, 2, 1, "", "TargetPrompt"], [2, 2, 1, "", "TargetPromptBatch"], [2, 1, 1, "", "logit_lens"], [2, 1, 1, "", "patch_object_attn_lens"], [2, 1, 1, "", "patchscope_generate"], [2, 1, 1, "", "patchscope_lens"], [2, 1, 1, "", "repeat_prompt"]], "nnterp.interventions.TargetPrompt": [[2, 3, 1, "", "index_to_patch"], [2, 3, 1, "", "prompt"]], "nnterp.interventions.TargetPromptBatch": [[2, 4, 1, "", "auto"], [2, 4, 1, "", "from_prompts"], [2, 4, 1, "", "from_target_prompt"], [2, 4, 1, "", "from_target_prompts"], [2, 3, 1, "", "index_to_patch"], [2, 3, 1, "", "prompts"]], "nnterp.nnsight_utils": [[2, 2, 1, "", "ModuleAccessor"], [2, 1, 1, "", "collect_last_token_activations_session"], [2, 1, 1, "", "collect_token_activations_batched"], [2, 1, 1, "", "compute_next_token_probs"], [2, 1, 1, "", "get_attention"], [2, 1, 1, "", "get_attention_output"], [2, 1, 1, "", "get_embed_tokens"], [2, 1, 1, "", "get_layer"], [2, 1, 1, "", "get_layer_input"], [2, 1, 1, "", "get_layer_output"], [2, 1, 1, "", "get_layers"], [2, 1, 1, "", "get_logits"], [2, 1, 1, "", "get_mlp"], [2, 1, 1, "", "get_mlp_output"], [2, 1, 1, "", "get_next_token_probs"], [2, 1, 1, "", "get_num_layers"], [2, 1, 1, "", "get_token_activations"], [2, 1, 1, "", "get_unembed"], [2, 1, 1, "", "get_unembed_norm"], [2, 1, 1, "", "project_on_vocab"], [2, 1, 1, "", "set_layer_output"]], "nnterp.nnsight_utils.ModuleAccessor": [[2, 4, 1, "", "get_attention"], [2, 4, 1, "", "get_embed_tokens"], [2, 4, 1, "", "get_layers"], [2, 4, 1, "", "get_mlp"], [2, 4, 1, "", "get_unembed"], [2, 4, 1, "", "get_unembed_norm"]], "nnterp.prompt_utils": [[2, 2, 1, "", "Prompt"], [2, 5, 1, "", "TokenizationError"], [2, 1, 1, "", "get_first_tokens"], [2, 1, 1, "", "next_token_probs_unsqueeze"], [2, 1, 1, "", "run_prompts"]], "nnterp.prompt_utils.Prompt": [[2, 4, 1, "", "from_strings"], [2, 4, 1, "", "get_target_probs"], [2, 4, 1, "", "has_no_collisions"], [2, 3, 1, "", "prompt"], [2, 4, 1, "", "run"], [2, 3, 1, "", "target_strings"], [2, 3, 1, "", "target_tokens"]], "nnterp.rename_utils": [[2, 2, 1, "", "AttentionProbabilitiesAccessor"], [2, 2, 1, "", "AttnProbFunction"], [2, 2, 1, "", "IOType"], [2, 2, 1, "", "LayerAccessor"], [2, 2, 1, "", "RenameConfig"], [2, 5, 1, "", "RenamingError"], [2, 1, 1, "", "bloom_attention_prob_source"], [2, 1, 1, "", "check_io"], [2, 1, 1, "", "check_model_renaming"], [2, 1, 1, "", "default_attention_prob_source"], [2, 1, 1, "", "default_attn_head_config_keys"], [2, 1, 1, "", "default_hidden_size_config_keys"], [2, 1, 1, "", "default_vocab_size_config_keys"], [2, 1, 1, "", "expand_path_with_model"], [2, 1, 1, "", "get_hidden_size"], [2, 1, 1, "", "get_ignores"], [2, 1, 1, "", "get_num_attention_heads"], [2, 1, 1, "", "get_rename_dict"], [2, 1, 1, "", "get_vocab_size"], [2, 1, 1, "", "gpt2_attention_prob_source"], [2, 1, 1, "", "gptj_attention_prob_source"], [2, 1, 1, "", "text_config"]], "nnterp.rename_utils.AttentionProbabilitiesAccessor": [[2, 4, 1, "", "check_source"], [2, 4, 1, "", "disable"], [2, 4, 1, "", "print_source"]], "nnterp.rename_utils.AttnProbFunction": [[2, 4, 1, "", "get_attention_prob_source"]], "nnterp.rename_utils.IOType": [[2, 3, 1, "", "INPUT"], [2, 3, 1, "", "OUTPUT"]], "nnterp.rename_utils.LayerAccessor": [[2, 4, 1, "", "get_module"], [2, 6, 1, "", "returns_tuple"]], "nnterp.rename_utils.RenameConfig": [[2, 3, 1, "", "attn_head_config_key"], [2, 3, 1, "", "attn_name"], [2, 3, 1, "", "attn_prob_source"], [2, 3, 1, "", "hidden_size_config_key"], [2, 3, 1, "", "ignore_attn"], [2, 3, 1, "", "ignore_mlp"], [2, 3, 1, "", "layers_name"], [2, 3, 1, "", "lm_head_name"], [2, 3, 1, "", "ln_final_name"], [2, 3, 1, "", "mlp_name"], [2, 3, 1, "", "model_name"], [2, 3, 1, "", "vocab_size_config_key"]], "nnterp.standardized_transformer": [[2, 2, 1, "", "StandardizedTransformer"]], "nnterp.standardized_transformer.StandardizedTransformer": [[2, 6, 1, "", "add_prefix_false_tokenizer"], [2, 6, 1, "", "attention_mask"], [2, 6, 1, "", "attn_probs_available"], [2, 4, 1, "", "detect_layer_output_type"], [2, 4, 1, "", "get_topk_closest_tokens"], [2, 3, 1, "", "hidden_size"], [2, 6, 1, "", "input_ids"], [2, 6, 1, "", "input_size"], [2, 6, 1, "", "logits"], [2, 6, 1, "", "next_token_probs"], [2, 3, 1, "", "num_heads"], [2, 3, 1, "", "num_layers"], [2, 4, 1, "", "probs_to_dict"], [2, 4, 1, "", "project_on_vocab"], [2, 4, 1, "", "skip_layer"], [2, 4, 1, "", "skip_layers"], [2, 4, 1, "", "steer"], [2, 6, 1, "", "token_embeddings"], [2, 3, 1, "", "vocab_size"]], "nnterp.utils": [[2, 2, 1, "", "ArchitectureNotFound"], [2, 2, 1, "", "DummyCache"], [2, 1, 1, "", "display_markdown"], [2, 1, 1, "", "display_source"], [2, 1, 1, "", "dummy_inputs"], [2, 1, 1, "", "is_notebook"], [2, 1, 1, "", "try_with_scan"], [2, 1, 1, "", "unpack_tuple"]], "nnterp.utils.DummyCache": [[2, 4, 1, "", "to_legacy_cache"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"], "5": ["py", "exception", "Python exception"], "6": ["py", "property", "Python property"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:attribute", "4": "py:method", "5": "py:exception", "6": "py:property"}, "terms": {"": [0, 2, 6, 8, 9], "0": [0, 1, 2, 3, 9], "1": [0, 1, 2, 3, 7, 8, 9, 10], "10": [5, 6, 9], "100": 10, "11": 10, "1135": 2, "12": 5, "16": 10, "1d": 2, "2": [2, 3, 6, 7, 8, 9], "2d": 2, "2f": 9, "3": [2, 3, 5, 7, 10], "300": 2, "32": 2, "4": 2, "400": 2, "5": [1, 2, 3, 5, 6, 7, 9, 10], "50": 2, "5x": 9, "6": 3, "7": 7, "768": [3, 7], "7b": [3, 8], "8": 5, "9": 10, "A": 2, "As": 9, "But": 6, "For": [0, 1, 2, 5, 9, 10], "If": [1, 2, 8], "In": [0, 2, 9], "It": 2, "Not": 2, "Or": 7, "The": [0, 1, 2, 3, 5, 6, 7, 8, 10], "Then": 9, "These": [3, 10], "To": [8, 9], "With": 9, "_": 9, "_kwarg": 2, "_london": 1, "_mad": 1, "_modul": 1, "abc": 2, "abstract": [1, 2], "access": [0, 2, 8, 9], "accessor": [0, 2], "across": [0, 1], "activ": [2, 3, 7], "ad": 6, "add": 5, "add_prefix_false_token": 2, "add_prefix_spac": 2, "add_trac": 1, "addit": [0, 2, 6, 8], "addition": 6, "advanc": 6, "affect": 2, "after": [0, 2, 8, 9], "all": [0, 1, 2, 3, 4, 6, 8, 9], "allclos": [0, 3, 9], "allow": [1, 2], "allow_dispatch": [2, 8], "along": [2, 10], "alongsid": 6, "alreadi": 2, "an": [2, 3, 6, 8], "analysi": 6, "analyz": 9, "ani": [1, 5, 6], "anoth": 7, "anyth": 6, "api": 4, "appli": [2, 3, 8, 9], "ar": [0, 1, 2, 6, 8], "architectur": [0, 2, 6, 8, 10], "architecturenotfound": 2, "argument": 2, "assert": [0, 1, 3, 9], "assum": 2, "asyncio": 2, "attach": 1, "attempt": 2, "attend": 2, "attent": [2, 3, 5, 9, 10], "attention_mask": 2, "attention_modul": [0, 2], "attention_output": 5, "attention_prob": [0, 1, 8], "attentionprobabilitiesaccessor": 2, "attentions_input": [0, 2], "attentions_output": [0, 2, 3, 5, 9], "attn": 10, "attn_0": 9, "attn_1": 9, "attn_head_config_kei": 2, "attn_idx_patch": 2, "attn_implement": [2, 8], "attn_nam": [0, 2], "attn_out": 10, "attn_output": 3, "attn_prob": [0, 1], "attn_prob_sourc": [0, 2], "attn_probs_avail": 2, "attnprobfunct": [0, 2], "attr_nam": 2, "attribut": 3, "auto": [2, 3, 8], "automat": [0, 6, 10], "automodelforcausallm": 1, "avail": [0, 2, 8], "avoid": [0, 2, 9], "azdrfa": 7, "back": [0, 2], "bar": 2, "base": 2, "basic": 6, "batch": [0, 1, 2, 7, 10], "batch_activ": 10, "batch_siz": [0, 1, 2, 8, 10], "beauti": 7, "becaus": 6, "becom": 0, "been": [2, 6, 8, 10], "befor": [0, 8, 9], "begin": 1, "behav": 8, "behavior": 6, "best": 6, "between": 2, "block": 2, "bloom_attention_prob_sourc": 2, "bool": 2, "both": [2, 7, 8], "built": [0, 2, 6, 9], "butanium": 6, "call": [0, 2, 9], "callabl": 2, "can": [0, 1, 2, 6, 8, 9], "cannot": [2, 7, 9], "capit": [1, 3, 5, 7, 10], "car": 7, "case": 8, "cat": 1, "categori": 1, "causal": 2, "certain": 2, "chang": [4, 8], "cheaper": 8, "check": [0, 1, 2, 8], "check_attn_probs_with_trac": 2, "check_io": 2, "check_model_renam": 2, "check_renam": 2, "check_sourc": 2, "citi": 7, "class": [0, 2, 8], "classmethod": 2, "closest": 2, "code": [2, 9], "collect": [2, 5, 9], "collect_last_token_activations_sess": 2, "collect_token_activations_batch": [2, 10], "com": 6, "combin": 5, "come": 8, "common": [0, 6, 9], "compat": [0, 6], "complex": [2, 6], "compon": [0, 5, 9], "comput": [0, 2, 7, 8], "compute_next_token_prob": 2, "condit": 0, "config": [0, 2], "configur": [2, 3], "conflict": 8, "consider": 0, "contain": 2, "context": [2, 7, 9], "conveni": [0, 1], "convent": [0, 3, 6, 8, 10], "convert": [1, 2], "convert_ids_to_token": 1, "correct": [0, 8, 9], "correct_answ": 1, "correctli": [2, 6, 8], "correspond": 0, "could": [0, 1, 8], "countri": 1, "cover": 9, "cpu": 2, "creat": [0, 1, 2], "critic": 9, "croissant": 7, "cross": 7, "current": [2, 8], "custom": [0, 2, 7], "custom_attent": [0, 2], "custom_ffn": 0, "custom_head": 0, "custom_lay": 0, "custom_norm": 0, "custom_transform": 0, "d": 2, "d_model": 2, "dataclass": 2, "datafram": [1, 2], "dataset": 10, "def": 0, "default": [2, 3, 8], "default_attention_prob_sourc": 2, "default_attn_head_config_kei": 2, "default_hidden_size_config_kei": 2, "default_vocab_size_config_kei": 2, "defin": 2, "depend": 1, "detail": 8, "detect": [0, 2], "detect_layer_output_typ": 2, "dev8": 9, "devic": [2, 3, 8], "device_map": [3, 8], "df": 1, "dict": [2, 10], "dictionari": [1, 2], "differ": [2, 3, 6, 8, 9], "dim": [0, 1], "dimens": [0, 2], "directli": [1, 2, 3, 5, 6, 7, 10], "disabl": [0, 2, 8], "dispatch": 2, "displai": [1, 5, 6], "display_markdown": 2, "display_sourc": 2, "doc": 4, "document": [4, 6], "doe": [2, 6], "doesn": [0, 2, 6], "don": [2, 8], "done": 2, "dot": 0, "dropout": 0, "due": 8, "dummi": 0, "dummy_input": 2, "dummycach": 2, "dure": [0, 2, 8], "e": [0, 2, 9], "each": [0, 1, 2, 7, 8], "eager": [2, 8], "easier": 6, "edg": 8, "effect": 2, "effici": 9, "either": [0, 6], "els": 0, "emb": 1, "embed": [0, 2], "embed_token": [0, 1, 2, 3], "enabl": [0, 1, 2, 8], "enable_attention_prob": [0, 1, 2, 8], "encoder_lay": 0, "encount": 2, "end_lay": 2, "england": 1, "ensur": [2, 8], "enum": 2, "environ": 2, "envoi": 2, "equival": [0, 2], "error": [2, 8, 9], "error_to_throw": 2, "errors_to_rais": 2, "essenti": 9, "etc": 6, "even": [1, 6, 8], "everi": 9, "exact": 8, "examin": 0, "exampl": [1, 2, 6], "except": [2, 9], "execut": 2, "exist": 2, "expand_path_with_model": 2, "expect": [0, 2, 6, 8], "explicitli": 8, "explor": 0, "extract": 2, "f": [1, 3, 9], "face": 2, "fact": 6, "factor": [2, 3], "fail": [0, 2, 8, 9], "failur": 8, "fall": [0, 2], "fallback": 2, "fals": [0, 2, 8], "fast": 8, "faster": 8, "featur": [0, 6], "feed": 2, "feed_forward": [0, 2], "ffn": [0, 2], "fig": 1, "figur": [1, 2], "file": [2, 4], "final": [0, 2, 9], "final_norm": 0, "find": [0, 8], "first": [0, 1, 2, 9], "flash": 8, "float": 2, "foggi": 7, "follow": [0, 2, 8], "forward": [0, 2, 9], "franc": [1, 3, 5, 7, 10], "from": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10], "from_pretrain": 1, "from_prompt": 2, "from_str": [1, 2], "from_target_prompt": 2, "full": [0, 2], "func_kwarg": 2, "function": [0, 1, 2, 10], "g": [0, 2], "gemma": [6, 10], "gener": 2, "get": [1, 2, 5, 10], "get_activ": 2, "get_attent": 2, "get_attention_output": [2, 10], "get_attention_prob_sourc": [0, 2], "get_embed_token": 2, "get_first_token": 2, "get_hidden_s": 2, "get_ignor": 2, "get_lay": [1, 2], "get_layer_input": 2, "get_layer_output": [2, 10], "get_logit": 2, "get_mlp": 2, "get_mlp_output": [2, 10], "get_modul": 2, "get_next_token_prob": 2, "get_num_attention_head": 2, "get_num_lay": 2, "get_prob": 2, "get_probs_func": [1, 2], "get_rename_dict": [1, 2], "get_target_prob": 2, "get_token_activ": [2, 10], "get_topk_closest_token": 2, "get_unemb": 2, "get_unembed_norm": 2, "get_vocab_s": 2, "git": 6, "github": 6, "given": 2, "go": [1, 2], "good": 6, "gpt": 6, "gpt2": [1, 3, 6, 8, 9, 10], "gpt2_attention_prob_sourc": 2, "gpt2lmheadmodel": 8, "gptj": 0, "gptj_attention_prob_sourc": 2, "gptjattnprobfunct": 0, "grad": 9, "graph_object": 1, "guarante": 2, "guid": [5, 9], "h": [2, 10], "ha": [0, 2, 6], "hacki": 2, "handl": [2, 10], "happen": 1, "has_no_collis": 2, "hasn": [6, 8], "have": [1, 2, 8, 10], "head": [0, 1, 2, 3], "height": 2, "hello": [0, 2, 3, 5, 6, 9, 10], "help": 9, "here": [0, 9], "hf": [3, 8], "hf_model": 1, "hidden": [2, 3, 7, 10], "hidden_s": [0, 2, 3, 7, 8, 10], "hidden_size_config_kei": 2, "hidden_st": [2, 7], "hook": [0, 1, 6, 8], "how": [0, 2], "howev": [1, 8, 10], "html": 2, "http": 6, "hug": 2, "huggingfac": [1, 2, 6, 8], "hypothet": 0, "i": [0, 1, 2, 5, 6, 7, 8, 9, 10], "id": 2, "idx": [2, 10], "ignor": 2, "ignore_attn": 2, "ignore_mlp": 2, "ignore_target": 2, "imag": 2, "immedi": [2, 8], "implement": [0, 1, 2, 6], "import": [0, 1, 3, 5, 6, 7, 8, 9, 10], "improv": 6, "includ": [2, 8, 9], "inclus": 2, "inconveni": 8, "incorrect": 9, "index": 2, "index_to_patch": [2, 7], "indic": [2, 6], "initi": [0, 2, 4], "initialized_with_en": 2, "input": [0, 2, 3], "input_id": 2, "input_s": 2, "insid": [0, 9], "instal": [2, 6], "instanc": 2, "instead": [2, 7], "int": 2, "integr": 4, "interact": 1, "interfac": [0, 5, 6, 8], "intermedi": [2, 9], "intern": [5, 6, 9], "interpret": 2, "interven": [2, 7], "intervent": [5, 6, 9], "inv_prob": 7, "invers": 7, "io_typ": 2, "iotyp": 2, "is_notebook": 2, "isinst": 1, "issu": 0, "item": 1, "its": 6, "itself": 6, "just": 1, "k": [1, 2], "keepdim": 1, "kei": [0, 2, 9], "king": 2, "know": [2, 6], "kwarg": 2, "l1": 9, "l1_grad": 9, "l1_grad_1": 9, "l1_grad_2": 9, "l1_out": 9, "l2": 9, "languag": [0, 2], "languagemodel": [2, 10], "larg": [9, 10], "large_prompt": 10, "last": [0, 2, 10], "latent": [2, 7], "later": 5, "latest": 6, "layer": [0, 1, 2, 5, 7, 8, 9], "layer_0": 9, "layer_5_out": [6, 9, 10], "layer_5_output": [3, 5], "layer_6_out": 3, "layer_out": 0, "layer_returns_tupl": 2, "layeraccessor": 2, "layers_input": [0, 2], "layers_modul": 1, "layers_nam": [0, 2], "layers_output": [0, 2, 3, 5, 6, 8, 9], "learn": [5, 6], "left": 2, "len": [1, 2, 5, 6], "length": 2, "level": 1, "like": 8, "line": 1, "list": [0, 1, 2, 7], "liter": 2, "ll": [6, 8], "llama": [2, 3, 6, 8, 10], "llamaforcausallm": 8, "llm_or_token": 2, "lm_head": [0, 1, 2, 3, 7], "lm_head_nam": [0, 2], "ln_f": 10, "ln_final": [0, 1, 2, 3, 7, 10], "ln_final_nam": [0, 2], "load": [0, 1, 2, 5, 6, 8, 10], "locat": [0, 8], "log": 2, "logit": [1, 2, 3, 5, 6, 9, 10], "logit_len": [1, 2, 7], "lon": 1, "london": [1, 7], "long": 10, "longstr": 1, "low": 1, "m": 8, "ma": 1, "madrid": 1, "main": [0, 2, 4, 6], "make": [2, 6], "manual": 0, "map": [0, 2], "marker": 1, "mask": [0, 2], "mat": 1, "match": [0, 2], "matric": 8, "max_batch_s": 2, "max_length": 2, "maximum": 2, "maykey": 5, "mean": [0, 2, 6, 9], "messag": 8, "meta": [3, 8], "method": [2, 5], "method_kwarg": 2, "mha": 0, "might": [1, 8], "minut": 5, "mismatch": 0, "mlp": [0, 1, 2, 3, 5, 9, 10], "mlp_0": 9, "mlp_8": 5, "mlp_block": 0, "mlp_name": [0, 2], "mlp_out": 10, "mlp_output": [3, 5], "mlps_input": [0, 2], "mlps_output": [0, 2, 3, 5, 9], "mode": 1, "model": [1, 2, 7, 9, 10], "model_nam": [0, 2], "modifi": [1, 2, 8], "modified_logit": 1, "modul": [0, 4, 5, 6, 8, 9], "module_accessor": 1, "moduleaccessor": [1, 2], "modulelist": [1, 2], "more": [6, 9, 10], "move": 2, "much": 10, "multipl": [2, 7], "multipli": 2, "must": [1, 2, 8, 9], "my": 9, "n": [2, 7], "n_embd": 2, "n_head": 2, "n_vocab": 2, "name": [1, 2, 3, 6, 8, 9, 10], "need": [0, 1, 2, 6, 9], "neg": 2, "negat": 7, "nest": 0, "net": 2, "new": [2, 8], "next": 2, "next_token_prob": 2, "next_token_probs_unsqueez": 2, "nfood": 7, "nn": [1, 2], "nn_model": 2, "nndif": 2, "nnsight": [2, 8], "nnsight_util": [6, 10], "nnterp": [0, 3, 5, 7, 9, 10], "non": [2, 8], "none": 2, "norm": [0, 2], "normal": [0, 2, 7, 8], "notabl": 4, "notat": 0, "note": [2, 6], "num_attention_head": 2, "num_head": [0, 2, 3, 8], "num_lay": [2, 3, 7, 9, 10], "num_patch": 2, "num_prompt": 2, "num_sourc": [2, 7], "num_target_prompt": 2, "number": [2, 3], "o": [0, 2], "object": [2, 9], "off": 2, "offici": [6, 8], "often": 9, "onc": [0, 2], "one": 7, "ones_lik": 0, "onli": [0, 9, 10], "open_context": 2, "oper": 2, "opt": 2, "option": 2, "organ": 2, "origin": [6, 8, 9], "other": [8, 9, 10], "output": [0, 2, 3, 5, 8, 9, 10], "overhead": 1, "own": [2, 6], "padding_sid": 2, "pair": 2, "panda": 2, "paper": 2, "param": 2, "paramet": [0, 2], "pari": [1, 7], "pass": [0, 1, 2, 8], "patch": 2, "patch_object_attn_len": 2, "patch_prompt": 2, "patchscop": [2, 5, 6], "patchscope_gener": 2, "patchscope_len": [2, 7], "patchscope_prob": 7, "path": 2, "pattern": [0, 1, 8, 9], "perfect": 8, "perform": [2, 6], "pip": [2, 5, 6], "pitfal": 9, "placehold": 2, "plan": 2, "plot": 2, "plot_topk_token": [1, 2], "plotli": [1, 2], "point": 0, "portion": 6, "posit": 2, "possibl": 0, "potenti": 2, "practic": 6, "pre": 7, "predict": [2, 7], "preserv": 6, "pretrainedmodel": 2, "pretrainedtokenizerbas": 2, "prevent": [8, 9], "print": [1, 3, 5, 9], "print_sourc": [1, 2, 8], "prob": [1, 2, 7], "probabl": [2, 6, 8], "probs_to_dict": 2, "process": [0, 2, 8], "progress": 2, "project": [2, 3, 4, 7], "project_on_vocab": [2, 3, 10], "prompt": [2, 7, 10], "prompt_util": [1, 6], "prompts_": 2, "prompts_to_df": [1, 2], "proper": 10, "properli": [2, 8], "properti": 2, "provid": [0, 1, 2, 6, 7, 9, 10], "proxi": 2, "python": [2, 8], "pytorch": 2, "quick": 6, "quirk": 1, "rais": [2, 8], "raise_error": 2, "ran": 2, "randn": [3, 7], "random": 0, "rang": [1, 9, 10], "rare": 2, "re": 8, "read": 4, "readi": 8, "reason": 1, "recommend": [1, 2, 10], "regular": 10, "rel": 2, "remain": [8, 9], "remot": 2, "remov": 1, "renam": [2, 6, 8, 9, 10], "rename_config": [0, 2], "rename_dict": 1, "rename_util": [0, 6], "renameconfig": 2, "renamed_model": 1, "renamingerror": 2, "renorm": 1, "repeat": 2, "repeat_prompt": [2, 7], "replac": [2, 6, 7], "repo_id": 2, "repositori": 2, "repres": 2, "requir": 0, "research": [0, 6, 8], "residu": 2, "result": [1, 3, 5], "results_skip": 3, "results_vanilla": 3, "retain_graph": 9, "return": [0, 1, 2, 6, 7, 8], "return_inv_logit": [2, 7], "return_module_sourc": [0, 2], "returns_df": 2, "returns_tupl": 2, "rich": 9, "rise": 7, "robust": 10, "root": 0, "rule": 9, "run": [0, 2, 5, 8], "run_prompt": [1, 2], "run_test": 8, "same": [0, 1, 2, 3, 6, 9], "sampl": 10, "sat": 1, "save": [0, 1, 2, 3, 5, 9], "save_html": 2, "scan": [0, 2], "scatter": 1, "sdpa": 8, "second": 9, "see": [2, 7, 8], "self": [0, 2], "self__attn_0": 0, "self_attent": 0, "self_attn": [0, 1, 2, 3, 10], "self_attn_dropout_0": 0, "sep": 2, "separ": 2, "seq_len": [0, 1, 2, 8], "sequenc": 2, "sequence_length": 2, "seri": 8, "server": 2, "session": 2, "set": [0, 1, 2, 5, 8], "set_layer_output": 2, "setter": 2, "setup": 4, "shape": [0, 1, 2, 6, 7, 8, 9, 10], "should": 2, "show": [1, 2, 9], "signific": 9, "silent": 8, "similar": 6, "simpl": 6, "sinc": [6, 8], "singl": [2, 7, 10], "size": [2, 3], "skip": 2, "skip_lay": [2, 3], "skip_with": [2, 3], "slower": 8, "so": [1, 9], "softmax": 7, "solut": 0, "some": [1, 2, 8, 10], "sourc": [0, 2, 7], "source_prompt": [2, 7], "space": 1, "spain": 1, "specif": [1, 2, 7, 8, 10], "specifi": [0, 2], "speedup": 9, "sphinx": 4, "standard": [0, 2, 6, 8], "standardized_transform": 6, "standardizedtransform": [0, 1, 2, 3, 5, 6, 8, 9, 10], "start": [2, 9], "start_lay": 2, "state": [2, 7], "statement": 0, "static": 2, "statu": 2, "std_model": 2, "steer": [2, 3, 5, 6], "steering_vector": [2, 3], "still": [1, 2, 6], "stop": [2, 3], "str": [2, 10], "stream": 2, "string": [1, 2], "structur": 2, "subsequ": 9, "succeed": 2, "successfulli": [0, 6, 8], "suggest": 8, "sum": [0, 1, 2, 5, 8, 9], "sun": 7, "support": [1, 2, 6, 8], "sure": 2, "syntax": 1, "t": [0, 2, 6, 8], "tailor": 9, "take": 2, "target": 2, "target_patch_prompt": [2, 7], "target_prompt": [2, 7], "target_str": 2, "target_token": [1, 2], "targetprompt": [2, 7], "targetpromptbatch": 2, "tensor": [0, 2, 7, 8], "tensor_or_tupl": 2, "test": [2, 6], "text": [2, 10], "text_config": 2, "th": 2, "than": 8, "thei": [8, 10], "them": [0, 1, 2, 6, 8, 9], "theme": 4, "thi": [0, 2, 4, 5, 6, 8, 9], "thoroughli": 0, "those": 10, "through": [2, 3, 6], "time": 9, "time_with_stop": 9, "time_without_stop": 9, "tini": 0, "tinyllama": 5, "titl": [1, 2], "tl": 2, "to_legacy_cach": 2, "todai": [3, 10], "toi": 8, "token": [0, 1, 2, 8, 10], "token_embed": [0, 2], "tokenizationerror": 2, "tolist": 1, "tool": 6, "top": [1, 2], "torch": [0, 1, 3, 7, 9], "tqdm": 2, "tqdm_asyncio": 2, "trace": [0, 1, 2, 3, 5, 6, 8, 9, 10], "traceabl": 8, "tracer": [2, 3, 10], "track": [1, 2], "transform": [0, 1, 2, 3, 5, 6, 8, 10], "transformer_len": [2, 6], "trap": 1, "tri": 2, "true": [0, 1, 2, 7, 8, 9], "trust": 2, "trust_remote_cod": 2, "try": [2, 8, 9], "try_with_scan": 2, "tupl": [0, 2], "turn": 2, "type": 2, "understand": [8, 9], "unemb": [2, 3], "unifi": [0, 1, 2, 5, 6], "univers": 1, "unmodifi": 8, "unpack_tupl": 2, "unsupport": 8, "unwrap": 0, "up": [5, 9], "update_layout": 1, "us": [0, 2, 3, 6, 7, 8, 10], "usabl": 10, "usag": [5, 6, 9], "use_hacky_implement": 2, "use_sess": 2, "use_token_id": 2, "use_trac": 2, "usual": 0, "util": 6, "v0": 5, "valid": [0, 2, 6], "valu": [2, 5], "vector": 2, "veri": 1, "verifi": [0, 6, 8], "via": 6, "visual": [2, 5], "vocab": [2, 7], "vocab_s": [2, 3], "vocab_size_config_kei": 2, "vocabulari": [2, 3], "wa": 2, "wai": [1, 3], "want": [0, 1, 2, 8, 9], "warn": [0, 2, 8], "warn_if_scan_fail": 2, "we": [0, 10], "weather": [3, 10], "weight": [0, 1, 2, 8], "were": [0, 8], "what": [0, 1, 6], "when": [0, 1, 2, 6, 7, 8, 9], "where": [0, 2, 8], "whether": 2, "which": [2, 8, 10], "while": [2, 6, 8], "who": 2, "why": 2, "width": 2, "within": 2, "without": [1, 2, 9], "won": [2, 8], "word": [2, 7], "work": [1, 2, 3, 5, 6, 8, 9, 10], "world": [0, 3, 5, 9], "would": 9, "write": 9, "written": 9, "x": [1, 9], "xaxis_titl": 1, "y": 1, "yaxis_titl": 1, "yet": 2, "you": [0, 1, 2, 5, 6, 8, 9], "your": [1, 2, 6, 8], "your_model": 1, "yujiepan": 0}, "titles": ["Adding Support for Your Model", "Advanced Features", "Documentation", "Basic Usage", "Changelog", "Quick Start", "<code class=\"docutils literal notranslate\"><span class=\"pre\">nnterp</span></code> - NNsight wrapper for Large Language Models", "Interventions", "Model Validation &amp; Testing", "NNsight Best Practices", "NNsight Utils"], "titleterms": {"": 1, "access": [1, 3, 5, 10], "activ": [5, 9, 10], "ad": [0, 4], "advanc": 1, "altern": 0, "analysi": [1, 7], "api": 6, "assign": 5, "attent": [0, 1, 8], "automat": 8, "backward": 9, "base": 0, "basic": [0, 3, 5, 9], "best": 9, "built": 3, "cach": 9, "cannot": 8, "changelog": 4, "class": 1, "collect": 10, "combin": 1, "compat": 8, "comput": 9, "configur": [0, 8], "direct": 5, "dispatch": 8, "displai": 2, "document": 2, "don": 9, "evolut": 1, "exampl": 0, "execut": 9, "featur": 1, "first": 5, "forget": 9, "get": 6, "gpt": 0, "gradient": 9, "guarante": 8, "guid": 6, "i": 3, "implement": 8, "instal": 5, "interfac": 3, "intern": 2, "intervent": [1, 2, 7], "j": 0, "languag": 6, "languagemodel": 1, "larg": 6, "layer": [3, 10], "len": 7, "load": 3, "logit": 7, "manual": 8, "method": [3, 7], "model": [0, 3, 5, 6, 8], "modul": [1, 2, 3], "multipl": [0, 9], "name": 0, "next": 5, "nnsight": [1, 6, 9, 10], "nnsight_util": 2, "nnterp": [1, 2, 6, 8], "o": 3, "off": 8, "optim": 9, "option": 0, "order": 9, "pass": 9, "patchscop": 7, "path": 0, "perform": 9, "plot": 1, "practic": 9, "probabl": [0, 1], "project": 10, "prompt": 1, "prompt_util": 2, "pytorch": 1, "quick": 5, "real": 0, "refer": 6, "renam": [0, 1], "rename_util": 2, "renameconfig": 0, "requir": [9, 10], "setup": 10, "skip": [3, 9], "standard": 3, "standardized_transform": 2, "start": [5, 6], "step": 5, "stop": 9, "structur": 0, "support": 0, "system": 8, "t": 9, "target": [0, 1], "test": [0, 8], "tracer": 9, "trade": 8, "troubleshoot": 0, "understand": 0, "unnecessari": 9, "unreleas": 4, "us": [1, 9], "usag": [0, 3], "user": 6, "util": [1, 2, 10], "valid": 8, "version": 8, "visual": 1, "what": 8, "wrapper": 6, "your": [0, 5]}})